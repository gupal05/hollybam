<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>í™€ë¦¬ë°¤ - í”„ë¦¬ë¯¸ì—„ ì„±ì¸ìš©í’ˆ ì‡¼í•‘ëª° | ë¦¬ì–¼ëŒ, ë”œë„, ëŸ¬ë¸Œì ¤</title>

  <!-- ê²€ìƒ‰ ì„¤ëª… -->
  <meta name="description" content="í™€ë¦¬ë°¤ì€ ë¦¬ì–¼ëŒ, ë”œë„, ì½˜ë”, ëŸ¬ë¸Œì ¤ ë“± í”„ë¦¬ë¯¸ì—„ ì„±ì¸ìš©í’ˆì„ ì•ˆì „í•˜ê²Œ ë¹ ë¥¸ë°°ì†¡í•˜ëŠ” ì˜¨ë¼ì¸ ì„±ì¸ìš©í’ˆ ì‡¼í•‘ëª°ì…ë‹ˆë‹¤. 19ì„¸ ì´ìƒë§Œ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.">
  <meta name="keywords" content="ì„±ì¸ìš©í’ˆ, ë¦¬ì–¼ëŒ, ë”œë„, ëŸ¬ë¸Œì ¤, ì½˜ë”, ì„±ì¸ì‡¼í•‘ëª°">
  <meta name="_csrf" th:content="${_csrf.token}"/>
  <meta name="_csrf_header" th:content="${_csrf.headerName}"/>


  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="í™€ë¦¬ë°¤">
  <meta property="og:locale" content="ko_KR">
  <meta property="og:title" content="í™€ë¦¬ë°¤ - í”„ë¦¬ë¯¸ì—„ ì„±ì¸ìš©í’ˆ ì‡¼í•‘ëª° | ë¦¬ì–¼ëŒ, ë”œë„, ëŸ¬ë¸Œì ¤">
  <meta property="og:description" content="í”„ë¦¬ë¯¸ì—„ ì„±ì¸ìš©í’ˆì„ ë¹ ë¥´ê²Œ ë°°ì†¡ë°›ìœ¼ì„¸ìš”.">
  <meta property="og:image" content="https://hollybam-static-image.s3.ap-northeast-2.amazonaws.com/images/hollybam_logo.webp">
  <meta property="og:url" content="https://holly-bam.com/"><!-- canonicalê³¼ ë™ì¼í•˜ê²Œ ìŠ¬ë˜ì‹œ í¬í•¨ -->

  <!-- Twitter Card (X) -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="í™€ë¦¬ë°¤ - í”„ë¦¬ë¯¸ì—„ ì„±ì¸ìš©í’ˆ ì‡¼í•‘ëª° | ë¦¬ì–¼ëŒ, ë”œë„, ëŸ¬ë¸Œì ¤">
  <meta name="twitter:description" content="í”„ë¦¬ë¯¸ì—„ ì„±ì¸ìš©í’ˆì„ ë¹ ë¥´ê²Œ ë°°ì†¡ë°›ìœ¼ì„¸ìš”.">
  <meta name="twitter:image" content="https://hollybam-static-image.s3.ap-northeast-2.amazonaws.com/images/hollybam_logo.webp">

  <!-- hreflang -->
  <link rel="alternate" href="https://holly-bam.com/" hreflang="ko-KR">
  <link rel="alternate" href="https://holly-bam.com/" hreflang="x-default">

  <!-- ëª¨ë°”ì¼ ìµœì í™” -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="data:,">

  <!-- í°íŠ¸ ìµœì í™”: preconnect ì¶”ê°€ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap"></noscript>

  <!-- CSS -->
  <link rel="preload" as="style" href="/css/intro.css" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/css/intro.css"></noscript>

  <!-- ì¸ë±ì‹±/ë¯¸ë¦¬ë³´ê¸° íŒíŠ¸ -->
  <meta name="robots" content="index,follow, max-image-preview:large">
  <!-- Canonical: ëŒ€í‘œ URLì„ / ë¡œ ê³ ì • -->
  <link rel="canonical" href="https://holly-bam.com/"/>

  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <!-- êµ¬ì¡°í™” ë°ì´í„° -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "í™€ë¦¬ë°¤",
      "url": "https://holly-bam.com/",
      "alternateName": ["Hollybam", "í™€ë¦¬ë°¤ ì„±ì¸ìš©í’ˆ"],
      "inLanguage": "ko",
      "logo": "https://hollybam-static-image.s3.ap-northeast-2.amazonaws.com/images/hollybam_logo.webp",
      "sameAs": [
        "https://www.instagram.com/holly._.bam",
        "https://www.youtube.com/@%ED%99%80%EB%A6%AC%EB%B0%A4"
      ]
    }
  </script>
</head>
<body>
<!-- ë¦¬ë‰´ì–¼ ì•ˆë‚´ ëª¨ë‹¬ -->
<div id="renewalModal" class="renewal-modal-overlay">
  <div class="renewal-modal">
    <div class="renewal-modal-header">
      <h1 class="visually-hidden">í™€ë¦¬ë°¤ - í”„ë¦¬ë¯¸ì—„ ì„±ì¸ìš©í’ˆ ì‡¼í•‘ëª° | ë¦¬ì–¼ëŒÂ·ë”œë„Â·ëŸ¬ë¸Œì ¤ ë¹ ë¥¸ë°°ì†¡</h1>
      <h2 class="renewal-modal-title">í™€ë¦¬ë°¤</h2>
      <p class="renewal-modal-subtitle">í™€ë¦¬ë°¤ ì„œë¹„ìŠ¤ ë¦¬ë‰´ì–¼ ì•ˆë‚´</p>
      <p class="renewal-modal-subtitle">ë” ë‚˜ì€ ì„œë¹„ìŠ¤ë¥¼ ìœ„í•œ ì‹œìŠ¤í…œ ê°œì„ </p>
    </div>
    <div class="renewal-modal-body">
      <div class="renewal-modal-content">
        ì•ˆë…•í•˜ì„¸ìš”.<br>
        í™€ë¦¬ë°¤ì„ ì´ìš©í•´ ì£¼ì‹œëŠ” ê³ ê°ë‹˜ê»˜ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤.
      </div>

      <div class="renewal-modal-highlight">
        <p class="renewal-modal-highlight-text">
          ì„œë¹„ìŠ¤ ì‹œìŠ¤í…œ ì „ë©´ ë¦¬ë‰´ì–¼ë¡œ ì¸í•´<br>
          <strong>ê¸°ì¡´ íšŒì›ë‹˜ë“¤ë„ ì‹ ê·œ ê°€ì…</strong>ì„ í•´ì£¼ì…”ì•¼ í•©ë‹ˆë‹¤.
        </p>
      </div>

      <div class="renewal-modal-content">
        ë³´ë‹¤ ì•ˆì „í•˜ê³  í¸ë¦¬í•œ ì„œë¹„ìŠ¤ ì œê³µì„ ìœ„í•œ<br>
        ë¶ˆê°€í”¼í•œ ì¡°ì¹˜ì„ì„ ì–‘í•´ ë¶€íƒë“œë¦½ë‹ˆë‹¤.
      </div>

      <p class="renewal-modal-apology">
        ì´ìš©ì— ë¶ˆí¸ì„ ë“œë ¤ ì§„ì‹¬ìœ¼ë¡œ ì£„ì†¡í•©ë‹ˆë‹¤.
      </p>
    </div>
    <div class="renewal-modal-footer">
      <button class="renewal-modal-button" onclick="closeRenewalModal()">
        í™•ì¸
      </button>
    </div>
  </div>
</div>

<!-- ë©”ì‹œì§€ë¥¼ ìˆ¨ê²¨ ë†“ìŒ -->
<div id="message" th:text="${session.message}" style="display: none;"></div>

<!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì•ˆì „í•˜ê²Œ ê°€ì ¸ì™€ alert -->
<script>
  // const msg = document.getElementById('message')?.textContent;
  // if (msg) {
  //   alert(msg);
  // }
</script>

<div class="container">
  <!-- ë©”ì‹œì§€ í‘œì‹œ ì˜ì—­ -->
  <div id="messageDiv" class="message"></div>
  <div id="loadingDiv" class="loading">ë³¸ì¸ì¸ì¦ì„ ì§„í–‰ì¤‘ì…ë‹ˆë‹¤...</div>

  <!-- ê²½ê³  ì•ˆë‚´ ì˜ì—­ -->
  <div class="section">
    <img th:src="'https://hollybam-static-image.s3.ap-northeast-2.amazonaws.com/images/intro_he01-0000 (1).jpg'" alt="í™€ë¦¬ë°¤ ë¦¬ì–¼ëŒ ë”œë„ ëŸ¬ë¸Œì ¤ ì½˜ë” ì„±ì¸ìš©í’ˆ ì‡¼í•‘ëª°" width="100" height="100"
         loading="lazy">
    <p>
      ì´ ì •ë³´ë‚´ìš©ì€ ì²­ì†Œë…„ ìœ í•´ë§¤ì²´ë¬¼ë¡œì„œ ì •ë³´í†µì‹ ë§ ì´ìš©ì´‰ì§„ë²• ë°<br>
      ì •ë³´ë³´í˜¸ ë“±ì— ê´€í•œ ë²•ë¥  ë° ì²­ì†Œë…„ ë³´í˜¸ë²•ì˜ ê·œì •ì— ì˜í•˜ì—¬<br>
      <b>19ì„¸ ë¯¸ë§Œì˜ ì²­ì†Œë…„</b>ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
    </p>
    <a href="javascript:history.back()" class="button">19ì„¸ ë¯¸ë§Œ ë‚˜ê°€ê¸°</a>
  </div>

  <!-- ë¡œê·¸ì¸ ì˜ì—­ -->
  <div class="section">
    <h3>íšŒì› ë¡œê·¸ì¸</h3>
    <form id="loginForm">
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
      <input type="text" id="memberId" name="username" placeholder="ì•„ì´ë”” ì…ë ¥" required>
      <input type="password" id="memberPw" name="password" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" required>
      <input type="submit" value="ë¡œê·¸ì¸">
    </form>

    <div class="social-buttons">
      <div style="cursor: pointer;" onclick="openNaverLogin()">
        <img th:src="'https://hollybam-static-image.s3.ap-northeast-2.amazonaws.com/images/btnG_padded_320x40.png'" alt="í™€ë¦¬ë°¤ ë„¤ì´ë²„ ë¡œê·¸ì¸" style="margin: 0; width: 100%; height: 100%;">
      </div>
      <div style="cursor: pointer; display: none">
        <img th:src="'https://hollybam-static-image.s3.ap-northeast-2.amazonaws.com/images/kakao_login_clean_320x40.png'" alt="í™€ë¦¬ë°¤ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸" style="margin: 0; width: 100%; height: 100%;">
      </div>
      <div id="g_id_signin"></div>

    </div>
  </div>

  <!-- êµ¬ë¶„ì„  -->
  <div class="divider"></div>

  <form name="form_chk" method="post">
    <input type="hidden" name="m" value="service"/>
    <input type="hidden" name="token_version_id" th:value="${token.token_version_id}"/>
    <input type="hidden" name="enc_data" th:value="${token.enc_data}"/>
    <input type="hidden" name="integrity_value" th:value="${token.integrity_value}"/>
    <input type="hidden" name="auth_type" value="S"/>
  </form>

  <!-- ë¹„íšŒì› ì„±ì¸ì¸ì¦ -->
  <div class="section certify">
    <h3>ë¹„íšŒì› ì„±ì¸ì¸ì¦</h3>
    <input type="button" value="íœ´ëŒ€í° ì¸ì¦ (NICE)" id="phoneAuthBtn" onclick="fnPopup()">
    <p>
      ë³¸ì¸ ëª…ì˜ì˜ íœ´ëŒ€í° ë˜ëŠ” ê°„í¸ ì¸ì¦ ìˆ˜ë‹¨ìœ¼ë¡œ ë³¸ì¸ì¸ì¦ì„ ì§„í–‰í•©ë‹ˆë‹¤.<br>
      ëª…ì˜ìì˜ ë‚˜ì´ ì •ë³´ë¡œ 19ì„¸ ë¯¸ë§Œ ì—¬ë¶€ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.
    </p>
  </div>
  <div style="width: 100%; height: 1px; background-color: #eee;"></div>
  <div style="text-align:center; font-size:14px; color:#555; line-height:1.6; margin-top:40px;">
    <strong>í™€ë¦¬ë°¤</strong>ì€ <b>ì„±ì¸ìš©í’ˆ ì‡¼í•‘ëª°</b>ë¡œ <b>ë¦¬ì–¼ëŒ, ë”œë„, ëŸ¬ë¸Œì ¤, ì½˜ë”</b> ë“±
    ê³ í’ˆì§ˆ ì„±ì¸ìš© ì œí’ˆì„ <b>ì•ˆì „í•˜ê³  ë¹ ë¥´ê²Œ ë°°ì†¡</b>í•©ë‹ˆë‹¤.
    ê³ ê°ë‹˜ì˜ í”„ë¼ì´ë²„ì‹œë¥¼ ìµœìš°ì„ ìœ¼ë¡œ ìƒê°í•˜ë©°,
    19ì„¸ ì´ìƒ ì„±ì¸ë§Œ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.
  </div>
</div>
<script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<script>
  $(document).ready(function() {
    // ğŸ”¥ ëª¨ë“  AJAX ìš”ì²­ì— CSRF í† í° ìë™ ì¶”ê°€
    var token = $("meta[name='_csrf']").attr("content");
    var header = $("meta[name='_csrf_header']").attr("content");

    $.ajaxSetup({
      beforeSend: function(xhr) {
        xhr.setRequestHeader(header, token);
      }
    });
  });

  // ë¦¬ë‰´ì–¼ ëª¨ë‹¬ ê´€ë ¨ ìŠ¤í¬ë¦½íŠ¸ (FCP ìµœì í™” ë° ì¤‘ë³µ ë°©ì§€)
  window.renewalModalState = window.renewalModalState || {
    shown: false,
    timeoutId: null
  };

  function closeRenewalModal() {
    document.getElementById('renewalModal').style.display = 'none';
    window.renewalModalState.shown = false; // ìƒˆë¡œê³ ì¹¨ ì‹œ ë‹¤ì‹œ ë³´ì´ê²Œ í•˜ê¸° ìœ„í•¨

    // timeoutì´ ì‹¤í–‰ ì¤‘ì´ë©´ ì·¨ì†Œ
    if (window.renewalModalState.timeoutId) {
      clearTimeout(window.renewalModalState.timeoutId);
      window.renewalModalState.timeoutId = null;
    }
  }

  function showRenewalModal() {
    const modal = document.getElementById('renewalModal');

    // ì´ë¯¸ í‘œì‹œë˜ì—ˆê±°ë‚˜ í˜„ì¬ ë³´ì´ëŠ” ìƒíƒœë¼ë©´ ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€
    if (window.renewalModalState.shown ||
            modal.style.display === 'flex' ||
            window.renewalModalState.timeoutId) {
      return;
    }

    // FCP ìµœì í™”ë¥¼ ìœ„í•´ ë” ê¸´ ì§€ì—° ì‹œê°„ ì ìš©
    window.renewalModalState.timeoutId = setTimeout(function () {
      // timeout ì‹¤í–‰ ì‹œì ì— ë‹¤ì‹œ í•œë²ˆ ì²´í¬
      if (!window.renewalModalState.shown && modal.style.display !== 'flex') {
        modal.style.display = 'flex';
        window.renewalModalState.shown = true;
      }
      window.renewalModalState.timeoutId = null;
    }, 1500); // FCP ê°œì„ ì„ ìœ„í•´ 1.5ì´ˆë¡œ ì¦ê°€
  }

  // í˜ì´ì§€ ë¡œë“œ ì‹œ ëª¨ë‹¬ í‘œì‹œ (FCP ê³ ë ¤)
  if (document.readyState === 'loading') {
    window.addEventListener('load', showRenewalModal);
  } else {
    // ì´ë¯¸ ë¡œë“œëœ ê²½ìš° ì¦‰ì‹œ ì‹¤í–‰
    showRenewalModal();
  }
</script>

<script>
  // êµ¬ê¸€ ë¡œê·¸ì¸ ê´€ë ¨ - ì›ìƒ ë³µêµ¬
  window.addEventListener('load', function () {
    google.accounts.id.initialize({
      client_id: "92346439771-d4b0tga52c1klh9f0qnrc31h51i8vfqm.apps.googleusercontent.com",
      callback: handleCredentialResponse,
    });

    const isMobile = window.innerWidth <= 768;

    google.accounts.id.renderButton(
            document.getElementById("g_id_signin"),
            {
              theme: "outline",
              size: "large",
              width: isMobile ? window.innerWidth - 40 : 320, // ëª¨ë°”ì¼ì—ì„œëŠ” ë™ì  ë„ˆë¹„
              height: isMobile ? 56 : 40
            }
    );
  });

  // ì°½ í¬ê¸° ë³€ê²½ ì‹œ ë²„íŠ¼ ì¬ë Œë”ë§
  window.addEventListener('resize', function() {
    const googleButtonContainer = document.getElementById("g_id_signin");
    if (googleButtonContainer) {
      // ê¸°ì¡´ ë²„íŠ¼ ì œê±°
      googleButtonContainer.innerHTML = '';

      // ìƒˆë¡œìš´ í¬ê¸°ë¡œ ì¬ë Œë”ë§
      const isMobile = window.innerWidth <= 768;
      google.accounts.id.renderButton(
              googleButtonContainer,
              {
                theme: "outline",
                size: "large",
                width: isMobile ? window.innerWidth - 40 : 320,
                height: isMobile ? 56 : 40
              }
      );
    }
  });

  function handleCredentialResponse(response) {
    console.log("ID í† í°:", response.credential);

    // í† í° ì„œë²„ ì „ì†¡
    $.ajax({
      type: "POST",
      url: "/auth/google-login",
      contentType: "application/json",
      data: JSON.stringify({ idToken: response.credential }),
      success: function (data) {
        console.log("êµ¬ê¸€ ë¡œê·¸ì¸ ì‘ë‹µ:", data);

        if (data.status === "existing_user") {
          // ê¸°ì¡´ íšŒì› - ë°”ë¡œ ë¡œë”© í˜ì´ì§€ë¡œ ì´ë™
          window.location.href = data.redirectUrl; // /loading
        } else if (data.status === "new_user") {
          // ì‹ ê·œ íšŒì› - íœ´ëŒ€í° ë³¸ì¸ì¸ì¦ íŒì—… ì—´ê¸°
          openGooglePhoneVerification();
        } else {
          alert("êµ¬ê¸€ ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + data.message);
        }
      },
      error: function (xhr, status, error) {
        console.error("êµ¬ê¸€ ë¡œê·¸ì¸ ì˜¤ë¥˜:", xhr.responseText);
        alert("êµ¬ê¸€ ë¡œê·¸ì¸ ì‹¤íŒ¨: " + error);
      }
    });
  }

  function openGooglePhoneVerification() {
    const width = 500;
    const height = 700;
    const left = (window.innerWidth - width) / 2;
    const top = (window.innerHeight - height) / 2;

    window.open(
            '/google/phone-verification',
            'googlePhoneVerificationPopup',
            `width=${width},height=${height},left=${left},top=${top}`
    );
  }

  function openNaverLogin() {
    const width = 500;
    const height = 600;
    const left = (window.innerWidth - width) / 2;
    const top = (window.innerHeight - height) / 2;

    window.open(
            '/auth/login/naver',
            'naverLoginPopup',
            `width=${width},height=${height},left=${left},top=${top}`
    );
  }
</script>
<script th:inline="javascript">
  let authPopup = null;

  window.addEventListener("message", function (event) {
    if (event.data === "authSuccess") {
      //alert("ì„±ì¸ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
      window.location.href = "/loading";
    } else if (event.data === "authFail") {
      alert("ì„±ì¸ì´ ì•„ë‹™ë‹ˆë‹¤. ì¸ì¦ì´ ì œí•œë©ë‹ˆë‹¤. ì•„ë‹Œë°");
      window.location.href = "/";
    }

    // ë„¤ì´ë²„ íšŒì›ê°€ì… ê´€ë ¨ ë©”ì‹œì§€ ì²˜ë¦¬ (ê¸°ì¡´)
    else if (event.data === "naverRegistrationComplete") {
      console.log("ë„¤ì´ë²„ íšŒì›ê°€ì… ì™„ë£Œ - /loadingìœ¼ë¡œ ì´ë™");
      window.location.href = "/loading";
    } else if (event.data === "naverRegistrationFailed") {
      console.log("ë„¤ì´ë²„ íšŒì›ê°€ì… ì‹¤íŒ¨");
      // í˜„ì¬ í˜ì´ì§€ ìœ ì§€ (ì¸íŠ¸ë¡œ í˜ì´ì§€)
    }
    // authPopupCallbackì—ì„œ ì§ì ‘ ì˜¨ ë©”ì‹œì§€ ì²˜ë¦¬ (ìƒˆë¡œ ì¶”ê°€)
    else if (event.data === "naverAuthSuccess") {
      console.log("ë„¤ì´ë²„ ë³¸ì¸ì¸ì¦ ì„±ê³µ - ìµœì¢… ì²˜ë¦¬ ëŒ€ê¸°");
      // naverPhoneVerificationì—ì„œ ì²˜ë¦¬í•˜ë„ë¡ í•¨
    } else if (event.data === "naverAuthFail") {
      console.log("ë„¤ì´ë²„ ë³¸ì¸ì¸ì¦ ì‹¤íŒ¨");
      alert("ì„±ì¸ì´ ì•„ë‹™ë‹ˆë‹¤. ì¸ì¦ì´ ì œí•œë©ë‹ˆë‹¤.");
    }// ë„¤ì´ë²„ ê¸°ì¡´ íšŒì› ë¡œê·¸ì¸ ì™„ë£Œ ì²˜ë¦¬ (ìƒˆë¡œ ì¶”ê°€)
    else if (event.data === "naverLoginComplete") {
      console.log("ë„¤ì´ë²„ ê¸°ì¡´ íšŒì› ë¡œê·¸ì¸ ì™„ë£Œ - /loadingìœ¼ë¡œ ì´ë™");
      window.location.href = "/loading";
    } else if (event.data === "googleRegistrationComplete") {
      console.log("êµ¬ê¸€ íšŒì›ê°€ì… ì™„ë£Œ - /loadingìœ¼ë¡œ ì´ë™");
      window.location.href = "/loading";
    } else if (event.data === "googleRegistrationFailed") {
      console.log("êµ¬ê¸€ íšŒì›ê°€ì… ì‹¤íŒ¨");
    }

    // íŒì—… ë‹«ê¸° ì‹œë„
    if (authPopup && !authPopup.closed) {
      authPopup.close();
    }
  });

  function fnPopup() {
    const tokenVersionId = document.querySelector('input[name="token_version_id"]').value;
    const encData = document.querySelector('input[name="enc_data"]').value;
    const integrityValue = document.querySelector('input[name="integrity_value"]').value;

    if (!tokenVersionId || !encData || !integrityValue) {
      alert('ì¸ì¦ì— í•„ìš”í•œ í† í° ì •ë³´ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.');
      return false;
    }

    if (authPopup && !authPopup.closed) {
      authPopup.close();
    }

    authPopup = window.open('', 'popupChk',
            'width=480,height=812,top=100,left=' + (screen.width / 2 - 240) +
            ',fullscreen=no,menubar=no,status=no,toolbar=no,titlebar=yes,location=no,scrollbars=no');

    if (!authPopup) {
      alert('íŒì—… ì°¨ë‹¨ë¨');
      return false;
    }

    document.form_chk.action = "https://nice.checkplus.co.kr/CheckPlusSafeModel/service.cb";
    document.form_chk.target = "popupChk";
    document.form_chk.submit();
  }

  /**
   * ê¸°ì¡´ ë¡œê·¸ì¸ í¼ ì²˜ë¦¬ (ì™„ì „íˆ ìœ ì§€)
   */
  $(document).ready(function () {
    // Thymeleaf ë©”ì‹œì§€ ì²˜ë¦¬
    const errorMsg = /*[[${session.error}]]*/ null;
    const successMsg = /*[[${session.success}]]*/ null;

    if (errorMsg) {
      showMessage(errorMsg, 'error');
    }
    if (successMsg) {
      showMessage(successMsg, 'success');
    }

    $("#loginForm").submit(function (event) {
      event.preventDefault();

      const memberId = $("#memberId").val().trim();
      const memberPw = $("#memberPw").val().trim();

      if (!memberId || !memberPw) {
        alert("ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        return;
      }

      $.ajax({
        url: "/auth/loginResult",
        method: "POST",
        contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
        data: {
          memberId: memberId,
          memberPw: memberPw
        },
        success: function (res) {
          if (res.loginResult === true) {
            window.location.href = '/loading';
          } else {
            alert("ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");
          }
        },
        error: function (xhr, status, error) {
          console.error("ë¡œê·¸ì¸ ìš”ì²­ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
          alert("ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
        }
      });
    });
  });

  /**
   * í˜ì´ì§€ ì´íƒˆ ì‹œ ì •ë¦¬
   */
  window.addEventListener('beforeunload', function() {
    if (typeof resetAuthState === 'function') {
      resetAuthState();
    }
  });
</script>

</body>
</html>